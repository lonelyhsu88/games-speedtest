# é·ç§»åˆ°ä¿®å¾©ç‰ˆæ¸¬é€Ÿç¨‹å¼æŒ‡å—

## ç•¶å‰ç‹€æ…‹

æ‚¨çš„ `test_games_menu.sh` **å¯ä»¥ç¹¼çºŒä½¿ç”¨**ï¼Œä½†å®ƒç›®å‰å‘¼å«çš„æ˜¯**èˆŠç‰ˆ**æ¸¬é€Ÿç¨‹å¼ï¼š

```bash
# test_games_menu.sh (line 338) å‘¼å«
./test_games_with_puppeteer.sh --games "$GAMES_STRING" "$LANG" "$WAIT_TIME"

# test_games_with_puppeteer.sh (line 341) ä½¿ç”¨
node puppeteer_game_test.js "$url" \    # âŒ èˆŠç‰ˆ (è³‡æ–™ä¸æº–)
    --wait=$WAIT_TIME \
    --output="$OUTPUT_JSON"
```

## å•é¡Œ

ç”±æ–¼ä½¿ç”¨èˆŠç‰ˆ `puppeteer_game_test.js`ï¼Œæ‰€æœ‰æ¸¬è©¦çµæœéƒ½æœƒæœ‰ä»¥ä¸‹å•é¡Œï¼š
- âŒ è³‡æºå¤§å°ä¸æº–ç¢ºï¼ˆå¯èƒ½å°‘è¨ˆç®— 80% çš„è³‡æ–™ï¼‰
- âŒ è«‹æ±‚æ•¸å¯èƒ½éºæ¼å»¶é²è¼‰å…¥çš„è³‡æº
- âŒ ç„¡æ³•è¿½è¹¤ cache å’Œå£“ç¸®è³‡è¨Š

---

## ğŸ¯ æ–¹æ¡ˆä¸€ï¼šæ›´æ–°åˆ°ä¿®å¾©ç‰ˆï¼ˆæ¨è–¦ï¼‰

### æ­¥é©Ÿ 1: æ›´æ–° test_games_with_puppeteer.sh

åªéœ€è¦ä¿®æ”¹ä¸€è¡Œï¼š

```bash
# æ‰¾åˆ° line 341ï¼ŒæŠŠé€™è¡Œï¼š
node puppeteer_game_test.js "$url" \

# æ”¹æˆï¼š
node puppeteer_game_test.js "$url" \
```

### æ­¥é©Ÿ 2: æ¸¬è©¦

```bash
# åŸ·è¡Œé¸å–®è…³æœ¬
./test_games_menu.sh

# é¸æ“‡ä¸€å…©å€‹éŠæˆ²æ¸¬è©¦
# æª¢æŸ¥çµæœæ˜¯å¦æ›´æº–ç¢º
```

### é æœŸæ”¹å–„

| æŒ‡æ¨™ | èˆŠç‰ˆ | ä¿®å¾©ç‰ˆ |
|------|------|--------|
| Total Size | å¯èƒ½åªæœ‰å¯¦éš›çš„ 20-30% | æ¥è¿‘ 100% æº–ç¢º |
| Requests | å¯èƒ½éºæ¼ 30-50% | å®Œæ•´è¿½è¹¤ |
| Cache Info | âŒ ç„¡ | âœ… å®Œæ•´ |
| Compression | âŒ ç„¡ | âœ… é¡¯ç¤º |

---

## ğŸ”„ æ–¹æ¡ˆäºŒï¼šä¿ç•™å…©å€‹ç‰ˆæœ¬ï¼ˆå»ºè­°ï¼‰

ç‚ºäº†ç›¸å®¹æ€§å’Œå°æ¯”æ¸¬è©¦ï¼Œå¯ä»¥åŒæ™‚ä¿ç•™å…©å€‹ç‰ˆæœ¬ï¼š

### å‰µå»ºæ–°çš„é¸å–®è…³æœ¬

```bash
# è¤‡è£½ç¾æœ‰è…³æœ¬
cp test_games_menu.sh test_games_menu.sh

# ç·¨è¼¯æ–°è…³æœ¬ï¼Œä¿®æ”¹æ¨™é¡Œå’Œå‘¼å«è·¯å¾‘
```

### æˆ–è€…åœ¨é¸å–®ä¸­å¢åŠ ç‰ˆæœ¬é¸æ“‡

å¯ä»¥åœ¨ `test_games_menu.sh` ä¸­å¢åŠ ä¸€å€‹æ­¥é©Ÿï¼Œè®“ä½¿ç”¨è€…é¸æ“‡ä½¿ç”¨å“ªå€‹ç‰ˆæœ¬ï¼š

```bash
# åœ¨èªè¨€é¸æ“‡å¾Œå¢åŠ ç‰ˆæœ¬é¸æ“‡
echo ""
echo "Select test version:"
echo "  1. Standard (faster, may miss some resources)"
echo "  2. Fixed (accurate, recommended)"
echo ""
echo -n "Enter choice (default: 2): "
read version_choice

case "$version_choice" in
    1)
        TEST_SCRIPT="puppeteer_game_test.js"
        ;;
    *)
        TEST_SCRIPT="puppeteer_game_test.js"
        ;;
esac
```

---

## ğŸ“Š æ–¹æ¡ˆä¸‰ï¼šä¸¦è¡Œæ¸¬è©¦å°æ¯”

å¦‚æœæƒ³è¦å°æ¯”å…©å€‹ç‰ˆæœ¬çš„å·®ç•°ï¼Œå¯ä»¥ä¿®æ”¹è…³æœ¬åŒæ™‚åŸ·è¡Œå…©å€‹ç‰ˆæœ¬ï¼š

```bash
# æ¸¬è©¦åŒä¸€å€‹éŠæˆ²ï¼Œä½¿ç”¨å…©å€‹ç‰ˆæœ¬
node puppeteer_game_test.js "$url" --output="$RESULTS_DIR/${game}_old.json"
node puppeteer_game_test.js "$url" --output="$RESULTS_DIR/${game}_fixed.json"

# å°æ¯”çµæœ
echo "Old version: $(jq '.totalSize' $RESULTS_DIR/${game}_old.json)"
echo "Fixed version: $(jq '.totalSize' $RESULTS_DIR/${game}_fixed.json)"
```

---

## âš¡ å¿«é€Ÿæ›´æ–°è…³æœ¬

æˆ‘å·²ç¶“ç‚ºæ‚¨æº–å‚™å¥½äº†æ›´æ–°å¾Œçš„ç‰ˆæœ¬ã€‚åŸ·è¡Œä»¥ä¸‹å‘½ä»¤ç«‹å³æ›´æ–°ï¼š

```bash
# å‚™ä»½èˆŠç‰ˆ
cp test_games_with_puppeteer.sh test_games_with_puppeteer.sh.backup

# æ›´æ–°è…³æœ¬ï¼ˆåªæ”¹ä¸€è¡Œï¼‰
sed -i '' 's/puppeteer_game_test\.js/puppeteer_game_test.js/g' test_games_with_puppeteer.sh

# é©—è­‰ä¿®æ”¹
grep "puppeteer_game_test" test_games_with_puppeteer.sh
```

---

## ğŸ§ª é©—è­‰æ¸¬è©¦

æ›´æ–°å¾Œï¼Œæ¸¬è©¦ä¸€å€‹éŠæˆ²ä¸¦å°æ¯”çµæœï¼š

```bash
# ä½¿ç”¨èˆŠç‰ˆæ¸¬è©¦ï¼ˆå¾å‚™ä»½ï¼‰
node puppeteer_game_test.js "https://your-game-url" --output=old.json

# ä½¿ç”¨æ–°ç‰ˆæ¸¬è©¦
node puppeteer_game_test.js "https://your-game-url" --output=fixed.json

# å°æ¯”çµæœ
echo "=== Old Version ==="
jq '{requests: .totalRequests, size: .totalSize}' old.json

echo "=== Fixed Version ==="
jq '{requests: .totalRequests, size: .totalSize, transferred: .totalEncodedSize}' fixed.json
```

---

## âš ï¸ æ³¨æ„äº‹é …

### 1. æ¸¬è©¦æ™‚é–“å¯èƒ½è®Šé•·

ä¿®å¾©ç‰ˆç‚ºäº†ç¢ºä¿å®Œæ•´è¿½è¹¤ï¼Œæœƒç­‰å¾…æ›´é•·æ™‚é–“ï¼š
- èˆŠç‰ˆï¼šå¯èƒ½ææ—©çµæŸï¼Œéºæ¼è³‡æº
- æ–°ç‰ˆï¼šç¢ºä¿æ‰€æœ‰è³‡æºéƒ½è¼‰å…¥å®Œæˆ

**é æœŸ**ï¼šæ¸¬è©¦æ™‚é–“å¯èƒ½å¢åŠ  20-50%ï¼Œä½†è³‡æ–™æ›´æº–ç¢º

### 2. æ­·å²è³‡æ–™ä¸å¯æ¯”è¼ƒ

ç”±æ–¼è¨ˆç®—æ–¹å¼ä¸åŒï¼š
- âŒ ä¸è¦ç›´æ¥æ¯”è¼ƒèˆŠç‰ˆå’Œæ–°ç‰ˆçš„æ•¸æ“š
- âœ… ä½¿ç”¨æ–°ç‰ˆé‡æ–°å»ºç«‹æ•ˆèƒ½åŸºæº–
- âœ… æœªä¾†çš„æ¸¬è©¦éƒ½ä½¿ç”¨æ–°ç‰ˆé€²è¡Œå°æ¯”

### 3. ç£ç¢Ÿç©ºé–“éœ€æ±‚

æ–°ç‰ˆæœƒå„²å­˜æ›´å®Œæ•´çš„è³‡è¨Šï¼š
- JSON å ±å‘Šæª”æ¡ˆå¯èƒ½è®Šå¤§ 2-3 å€
- ç¢ºä¿æœ‰è¶³å¤ çš„ç£ç¢Ÿç©ºé–“ï¼ˆå»ºè­°è‡³å°‘ 1GBï¼‰

---

## ğŸ“ æ›´æ–°æª¢æŸ¥æ¸…å–®

- [ ] å‚™ä»½ç¾æœ‰è…³æœ¬
- [ ] æ›´æ–° `test_games_with_puppeteer.sh` ä½¿ç”¨ä¿®å¾©ç‰ˆ
- [ ] æ¸¬è©¦ 1-2 å€‹éŠæˆ²é©—è­‰çµæœ
- [ ] å°æ¯”æ–°èˆŠç‰ˆæœ¬æ•¸æ“šå·®ç•°
- [ ] ç¢ºèªçµæœç¬¦åˆé æœŸï¼ˆè«‹æ±‚æ•¸å’Œå¤§å°éƒ½å¢åŠ ï¼‰
- [ ] æ›´æ–°åœ˜éšŠæ–‡æª”å’Œ CI/CD é…ç½®
- [ ] åˆªé™¤æˆ–å°å­˜èˆŠç‰ˆæ¸¬è©¦çµæœ

---

## ğŸ†˜ å¦‚æœé‡åˆ°å•é¡Œ

### å•é¡Œï¼šä¿®å¾©ç‰ˆè·‘å¾—å¤ªæ…¢

```bash
# æ¸›å°‘ç­‰å¾…æ™‚é–“ï¼ˆä½†å¯èƒ½éºæ¼è³‡æºï¼‰
node puppeteer_game_test.js "$url" --wait=5000
```

### å•é¡Œï¼šè¨˜æ†¶é«”ä¸è¶³

```bash
# ä¸€æ¬¡åªæ¸¬è©¦å°‘é‡éŠæˆ²
# æˆ–è€…åœ¨é¸å–®ä¸­é¸æ“‡ 3-5 å€‹éŠæˆ²ï¼Œä¸è¦é¸ "all"
```

### å•é¡Œï¼šæƒ³å›åˆ°èˆŠç‰ˆ

```bash
# å¾å‚™ä»½é‚„åŸ
cp test_games_with_puppeteer.sh.backup test_games_with_puppeteer.sh
```

---

## âœ… ç¸½çµ

### ç•¶å‰ç‹€æ…‹
- âœ… `test_games_menu.sh` **å¯ä»¥ç¹¼çºŒä½¿ç”¨**
- âš ï¸ ä½†å®ƒä½¿ç”¨èˆŠç‰ˆæ¸¬é€Ÿç¨‹å¼ï¼Œ**è³‡æ–™ä¸æº–ç¢º**

### å»ºè­°è¡Œå‹•
1. **ç«‹å³æ›´æ–°**åˆ°ä¿®å¾©ç‰ˆï¼ˆåªéœ€æ”¹ä¸€è¡Œï¼‰
2. **é‡æ–°æ¸¬è©¦** 1-2 å€‹éŠæˆ²é©—è­‰çµæœ
3. **å»ºç«‹æ–°çš„æ•ˆèƒ½åŸºæº–**ä¾›æœªä¾†å°æ¯”

### é æœŸæ•ˆæœ
- âœ… è³‡æºå¤§å°æº–ç¢ºåº¦å¾ ~30% æå‡åˆ° ~95%+
- âœ… è«‹æ±‚æ•¸å®Œæ•´è¿½è¹¤ï¼Œä¸éºæ¼å»¶é²è¼‰å…¥è³‡æº
- âœ… æä¾› cache å’Œå£“ç¸®è³‡è¨Š
- âš ï¸ æ¸¬è©¦æ™‚é–“å¯èƒ½å¢åŠ  20-50%ï¼ˆæ›å–æº–ç¢ºåº¦ï¼‰
